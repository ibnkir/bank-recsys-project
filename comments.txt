17.09.2024, 08:00
2-я итерация

Артем, привет,

Высылаю драфт проекта. К сожалению, я забуксовал на метрике для базовой модели и не могу 
двигаться дальше (деплой итп занимает всего пару часов, поэтому я до последнего надеялся успеть). 

Буду обсуждать перенос дедлайна с кураторами, а сейчас хотел бы спросить, 
что можно поправить в моем решении или может вообще выбрать другой подход,
т.к. это известный каггловский кейс, и ты наверняка видел различные решения.

Мой подход описан в EDA (см. выводы по результатам EDA в ноутбуке или 
в readme). Если в двух словах: я добавил новые признаки - продукты на начало
месяца, новые таргеты - покупка в течение месяца, добавил еще пару новых признаков
вроде месяца наблюдения и ск-ко лет человек является клиентом. Проверил сезонность покупок
для "старых" клиентов (т.е. тех, кто стал клиентами до 01.01.2015). Соответственно,
оставил только наблюдения в феврале-июне каждого года. 

Я использую catboost клсф с функцией MultiLogloss, 
но вместе с пайплайном он не обучается, т.к. колоночный 
трансформер, во-первых, почему-то требует таргет,
а во-вторых, чтобы он был одноразмерным, поэтому я запускаю их отдельно.
В итоге получаю нулевую метрику MAP@7, хотя для бейзлайна на основе популярных продуктов она 0.008

В общем, что лучше предпринять? Может я неправильно считаю MAP@7 ? Хотя на самом деле
почти все реализации этой метрики на гитхабе противоречат определению, 
поэтому я использую свой вариант.
Плюс там еще нюанс: проходить ли эти 7 продуктов в том порядке, в котором они встречаются
в датасете, или может в порядке популярности?

Ну и что касается таргетов, может объединить их в одну строковую колонку или посчитать
число по их двоичной записи? Мне лично казалось, что multi-labeld классификация - это
самый логичный вариант для этой задачи. Какие рабочие варианты тебе встречались?



Спасибо.
